# プラグイン開発規約
# claude-naggarプラグイン(.claude/plugins/)の開発・編集時に遵守する規約

rules:
  must:
    - plugin.jsonのバージョンバンプ: ファイル追加・変更時は必ずplugin.jsonのversionをインクリメントすること（キャッシュ反映に必須）
    - プラグインリポジトリでcommit: プラグインは独立gitリポジトリ。プラグインディレクトリ内でcommit/pushすること
    - コミットメッセージにissue_id: チケット番号(issue_{id})をコミットメッセージに含めること
    - git push必須: commit後は必ずpushすること（GitHubマーケットプレースautoUpdate反映に必須）

  must_not:
    - 親リポジトリでのcommit: プラグインファイルの変更を親リポジトリ(claude-nagger)でcommitしない
    - バージョンバンプなしのファイル追加: キャッシュに反映されず変更が無視される
    - commitのみでpush忘れ: キャッシュが更新されずhookが反映されない

  should:
    - セマンティックバージョニング: パッチ(0.0.x)で小修正、マイナー(0.x.0)で機能追加
    - agent定義変更時はdescription(frontmatter)の整合性確認
    - Docker環境のTMPDIR: devcontainer.jsonでTMPDIR=/home/node/.claude/.tmpを設定すること（EXDEV回避）

commands:
  test: "cd .claude/plugins/{plugin-name} && git status"
  commit: "cd .claude/plugins/{plugin-name} && git add -A && git commit -m '[coder] issue_{id}: 変更内容'"

workflow:
  description: "ticket-tasuki開発ワークフロー"
  steps:
    - "agents/*.mdまたはプラグインファイルを編集"
    - ".claude-plugin/plugin.json のバージョンをバンプ（必須）"
    - "git commit & push（pushまで必須。autoUpdate反映のため）"
    - "Claude Codeセッション再起動で反映"
  notes:
    - "バージョンバンプなしのファイル追加はキャッシュに反映されない"
    - "マーケットプレース: ticket-tasuki@ticket-tasuki（GitHub autoUpdate:true）"
    - "pushしないとGitHubマーケットプレースに反映されない"

related_files:
  file_conventions: "@packages/claude-nagger/.claude-nagger/file_conventions.yaml"
  plugin_json: ".claude/plugins/{plugin-name}/.claude-plugin/plugin.json"
